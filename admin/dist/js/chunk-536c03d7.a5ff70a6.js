(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-536c03d7"],{3903:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("modal-box",{attrs:{"is-active":t.isModalActive,"trash-object-name":t.trashObjectName},on:{confirm:t.trashConfirm,cancel:t.trashCancel}}),a("aside-menu"),a("hero-bar",[a("b-icon",{attrs:{icon:"headset",size:"is-medium"}}),t._v(" "+t._s(t.heroTitle)+" ")],1),a("section",{staticClass:"section is-main-section"},[a("card-component",{staticClass:"tile is-child"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[a("b-field",{attrs:{label:"Abierto",horizontal:""}},[a("b-switch",{model:{value:t.form.open,callback:function(e){t.$set(t.form,"open",e)},expression:"form.open"}})],1),a("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.form.open,expression:"!form.open"}],attrs:{type:"is-success",loading:t.saving},on:{click:t.close}},[t._v("Declarar como resuelto")]),a("hr"),a("b-field",{attrs:{label:"Área de gestión"}},[a("b-select",{attrs:{placeholder:"Cateogría",disabled:"new"!==t.$route.params.id,required:""},model:{value:t.form.department,callback:function(e){t.$set(t.form,"department",e)},expression:"form.department"}},t._l(t.departments,(function(e,s){return a("option",{key:s,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)],1),a("hr"),a("b-field",{attrs:{label:"¿Cuál es el problema?",message:"Descripción breve del reclamo"}},[a("b-input",{attrs:{placeholder:"No puedo subir una foto",disabled:"new"!==t.$route.params.id,required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("b-field",{attrs:{label:"Describí de qué se trata tu reclamo"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.text,expression:"form.text"}],staticClass:"textarea is-rows-condensed",attrs:{disabled:"new"!==t.$route.params.id,placeholder:"Cuando voy a catálogo no puedo subir fotos, me dice que el tamaño no es correcto",required:""},domProps:{value:t.form.text},on:{input:function(e){e.target.composing||t.$set(t.form,"text",e.target.value)}}})]),a("hr"),a("b-field",{attrs:{label:"Adjunto",horizontal:""}},[a("b-field",{directives:[{name:"show",rawName:"v-show",value:"new"===t.$route.params.id,expression:"$route.params.id === 'new'"}],attrs:{label:""}},[a("file-picker",{on:{fileUploaded:t.handleFileUploaded}})],1),a("b-field",{attrs:{label:""}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.form.photo,expression:"form.photo"}],staticClass:"box photo-box has-text-right"},[a("button",{staticClass:"button is-large is-text",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.trashModal(t.form.photo)}}},[a("b-icon",{staticClass:"has-text-danger",attrs:{icon:"close",size:"is-small"}})],1),a("img",{attrs:{src:t.form.photo}})])])],1),a("hr"),a("card-component",{staticClass:"has-table has-mobile-sort-spaced",attrs:{title:"Conversación",icon:"account"}},t._l(t.form.conversation,(function(e,s){return a("div",{key:s},[a("div",{staticClass:"column"},[a("div",{staticClass:"column",class:{"has-text-right":!e.staff}},[e.staff?t._e():a("div",{staticClass:"columns is-vcentered"},[a("div",{staticClass:"column is-narrow"},[a("div",{staticClass:"is-photo ",style:"background-image:url("+e.photo+")"})]),a("div",{staticClass:"column is-narrow is-paddingless-left"},[a("h6",{staticClass:"is-flex subtitle"},[t._v(t._s(e.name)+" ")])])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("span",{staticClass:"is-size-7 has-text-grey"},[a("b-icon",{attrs:{size:"is-small",icon:"clock"}}),t._v(" "+t._s(t._f("fromNow")(e.created)))],1),a("p",[t._v(t._s(e.text))]),e.attachment?a("div",{staticClass:"is-photo is-large",style:"background-image:url("+e.attachment+")"}):t._e()])])])]),a("hr")])})),0),a("hr"),a("b-field",{attrs:{label:"Tu respuesta"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.response,expression:"response"}],staticClass:"textarea is-rows-condensed",attrs:{placeholder:"Escribí tu respuesta acá",required:""},domProps:{value:t.response},on:{input:function(e){e.target.composing||(t.response=e.target.value)}}})]),a("b-field",{attrs:{label:"Adjunto",horizontal:""}},[a("b-field",{attrs:{label:""}},[a("file-picker",{on:{fileUploaded:t.handleConversationFileUploaded}})],1),a("b-field",{attrs:{label:""}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.conversationPhoto,expression:"conversationPhoto"}],staticClass:"box photo-box has-text-right"},[a("div",{staticClass:"is-photo is-large",style:"background-image:url("+t.conversationPhoto+")"})])])],1),a("hr"),a("div",{staticClass:"buttons is-flex-end"},[a("b-button",{attrs:{type:"is-primary",loading:t.saving,"native-type":"submit"}},[t._v("Contestar")])],1)],1)])],1)],1)},o=[],i=(a("a4d3"),a("4de4"),a("4160"),a("a15b"),a("b0c0"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("25f0"),a("159b"),a("ade3")),n=a("2f62"),r=a("bc3a"),c=a.n(r),l=a("c1df"),u=a.n(l),d=a("d000"),p=a("25f7"),m=a("503b"),f=a("6df7"),h=a("3b73"),b=a("72d0");function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var C={name:"ticket",components:{NavBar:d["a"],AsideMenu:p["a"],CardComponent:f["a"],HeroBar:m["a"],FilePicker:h["a"],ModalBox:b["a"]},props:{id:{default:null}},data:function(){return{departments:["General","Ventas","Dominios","Departamento Técnico"],response:null,conversationPhoto:null,isModalActive:!1,saving:!1,htmlForEditor:"",form:this.getClearFormObject(),createdReadable:null,isProfileExists:!1}},computed:g({trashObjectName:function(){return this.trashObject?this.trashObject:null},callAction:function(){return{link:"/tickets",icon:"headset",title:"Ticket"}},heroTitle:function(){return this.isProfileExists?this.form.name:"Nuevo ticket"},heroRouterLinkTo:function(){return this.isProfileExists?"/tickets/"+this.$route.params.id+"/new":"/tickets"},heroRouterLinkLabel:function(){return this.isProfileExists?"Nuevo Ticket":"Tickets"},formCardTitle:function(){return this.isProfileExists?"Editar ticket":"Nuevo ticket"}},Object(n["b"])(["basic","auth"])),created:function(){this.getData()},methods:{close:function(){var t=this;this.saving=!0,c.a.post("/tickets/".concat(this.$route.params.id),{open:!1}).then((function(e){e.data&&(t.$buefy.snackbar.open({message:"Ticket cerrado",queue:!1}),t.$router.push({name:"tickets"}))})).catch((function(e){t.$buefy.toast.open({message:"Error: ".concat(e.message),type:"is-danger",queue:!1})}))},handleFileUploaded:function(t){this.$set(this.form,"photo",t[0])},handleConversationFileUploaded:function(t){this.conversationPhoto=t[0]},trashModal:function(t){this.trashObject=t,this.isModalActive=!0},trashConfirm:function(){var t=this;this.saving=!0,this.isModalActive=!1,c.a.post(["upload","delete"].join("/"),{files:[this.trashObject]}).then((function(e){t.saving=!1,t.form.photo=null}))},trashCancel:function(){this.isModalActive=!1},getClearFormObject:function(){return{_id:null,name:null,conversation:[],created:new Date}},getData:function(){var t=this;this.$route.params.id&&"new"!==this.$route.params.id&&c.a.get("/tickets/"+this.$route.params.id).then((function(e){var a=e.data;a?(t.isProfileExists=!0,t.form=a):t.$router.push({name:"tickets.new"})})).catch((function(e){t.$buefy.toast.open({message:"Error: ".concat(e.message),type:"is-danger",queue:!1})}))},input:function(t){this.createdReadable=u()(t).format("MMM D, Y").toString()},submit:function(){var t=this;this.saving=!0,this.form.conversation.push({staff:!0,name:[this.auth.user.first_name,this.auth.user.last_name].join(" "),photo:this.auth.user.photo,attachment:this.conversationPhoto,text:this.response,created:u()().format()}),this.saving=!1,c.a.post("/tickets/"+this.$route.params.id,{conversation:this.form.conversation,answered:!0}).then((function(e){e.data&&(t.$buefy.snackbar.open({message:"Ticket contestado",queue:!1}),t.$router.push({name:"tickets"}))})).catch((function(e){t.$buefy.toast.open({message:"Error: ".concat(e.message),type:"is-danger",queue:!1})}))}}},k=C,x=a("2877"),w=Object(x["a"])(k,s,o,!1,null,null,null);e["default"]=w.exports},"3b73":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-field",{staticClass:"file"},[a("b-upload",{staticClass:"is-clickable",attrs:{accept:t.accept},on:{input:t.upload},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}},[t.buttonLabel?a("a",{staticClass:"button is-dark is-outlined",style:t.uploadPercent?"background: linear-gradient(to right,#f4f3ef "+t.uploadPercent+"px,transparent "+t.uploadPercent+"px)":""},[a("span",[t._v(t._s(t.buttonLabel))])]):t._e(),a("b-icon",{attrs:{else:"",icon:"file-upload",type:"is-primary",size:"is-medium"}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.uploadPercent,expression:"uploadPercent"}],staticClass:"is-upload-progress animated loop flash",style:t.uploadPercent?"background: linear-gradient(to right,#00d1b2 "+t.uploadPercent+"px,transparent "+t.uploadPercent+"px)":""})],1)},o=[],i=a("bc3a"),n=a.n(i),r={name:"FilePicker",props:{dataLabel:null,dataVideo:null,accept:{type:String,default:null}},data:function(){return{label:"Cargar",file:null,uploadPercent:0}},computed:{buttonLabel:function(){return this.dataLabel},video:function(){return this.dataVideo||!1}},methods:{upload:function(t){var e=this,a=new FormData;a.append("files",t),n.a.post("/upload/multi",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:this.progressEvent}).then((function(t){"error"===t.data.status?e.$buefy.toast.open({message:"Error: ".concat(t.data.message),type:"is-danger"}):(e.uploadPercent=0,e.$emit("fileUploaded",t.data))})).catch((function(t){e.$buefy.toast.open({message:"Error: ".concat(t.message),type:"is-danger"})}))},progressEvent:function(t){this.uploadPercent=Math.round(100*t.loaded/t.total)}}},c=r,l=a("2877"),u=Object(l["a"])(c,s,o,!1,null,null,null);e["a"]=u.exports},"72d0":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{attrs:{active:t.isModalActive,"has-modal-card":""},on:{"update:active":function(e){t.isModalActive=e}}},[a("div",{staticClass:"modal-card"},[a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Confirmar acción")])]),a("section",{staticClass:"modal-card-body"},[a("p",[t._v("Esta acción eliminará de forma permanente "),a("b",[t._v(t._s(t.trashObjectName))])])]),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button ",attrs:{type:"button"},on:{click:t.cancel}},[t._v("Cancelar")]),a("button",{staticClass:"button is-danger ",on:{click:t.confirm}},[t._v("Eliminar")])])])])},o=[],i={name:"ModalBox",props:{isActive:{type:Boolean,default:!1},trashObjectName:{type:String,default:null}},data:function(){return{isModalActive:!1}},methods:{cancel:function(){this.$emit("cancel")},confirm:function(){this.$emit("confirm")}},watch:{isActive:function(t){this.isModalActive=t},isModalActive:function(t){t||this.cancel()}}},n=i,r=a("2877"),c=Object(r["a"])(n,s,o,!1,null,null,null);e["a"]=c.exports},b0c0:function(t,e,a){var s=a("83ab"),o=a("9bf2").f,i=Function.prototype,n=i.toString,r=/^\s*function ([^ (]*)/,c="name";!s||c in i||o(i,c,{configurable:!0,get:function(){try{return n.call(this).match(r)[1]}catch(t){return""}}})}}]);
//# sourceMappingURL=chunk-536c03d7.a5ff70a6.js.map