(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-85800598"],{"2b9d":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.isDismissed?t._e():e("div",{staticClass:"notification"},[t.dismissable?e("button",{staticClass:"delete",on:{click:t.dismiss}}):t._e(),e("div",{staticClass:"level"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[t._t("default")],2)]),t.action?e("div",{staticClass:"level-right level-right-padded"},[e("div",{staticClass:"level-item"},[e("button",{staticClass:"button is-small is-white",attrs:{type:"button"}},[t._v(t._s(t.action.name))])])]):t._e()])])},i=[],n={name:"Notification",props:{dismissable:{type:Boolean,default:!0},action:{type:Object,default:function(){}}},data:function(){return{isDismissed:!1}},methods:{dismiss:function(){this.isDismissed=!0}}},o=n,r=e("2877"),l=Object(r["a"])(o,s,i,!1,null,null,null);a["a"]=l.exports},"49d1":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("modal-box",{attrs:{"is-active":t.isModalActive,"trash-object-name":t.trashObjectName},on:{confirm:t.trashConfirm,cancel:t.trashCancel}}),e("nav-bar"),e("aside-menu"),e("hero-bar",[e("b-icon",{attrs:{icon:"shopping",size:"is-medium"}}),t._v(" Tiendas "),e("div",{staticClass:"buttons",attrs:{slot:"right"},slot:"right"},[e("a",{staticClass:"button",on:{click:t.getData}},[e("span",[t._v("Actualizar")])])])],1),e("section",{staticClass:"section is-main-section"},[t.data?e("card-component",[e("b-table",{staticClass:"sales-table",attrs:{data:t.data,"default-sort-direction":"desc","default-sort":"created","detail-key":"_id",detailed:"",focusable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("b-table-column",{attrs:{field:"id",label:"#",width:"40",sortable:"",searchable:""}},[e("a",{staticClass:"tag",class:{"is-success":a.row.wizard_complete,"is-danger":!a.row.wizard_complete},attrs:{href:"https://"+a.row.id+".overlemon.com",title:"Ver tienda",target:"_blank"}},[e("span",{staticClass:"has-text-weight-bold"},[t._v(" "+t._s(a.row.id))])])]),e("b-table-column",{attrs:{field:"shop",label:"Tienda",sortable:"",searchable:""}},[e("span",{staticClass:"is-capitalized"},[t._v(t._s(a.row.shop))]),e("span",{directives:[{name:"show",rawName:"v-show",value:a.row.domain,expression:"props.row.domain"}],staticClass:"is-lowercase tag is-small"},[t._v(t._s(a.row.domain))])]),e("b-table-column",{attrs:{field:"first_name",label:"Nombre",sortable:"",searchable:""}},[e("span",{staticClass:"is-capitalized"},[t._v(t._s(a.row.first_name))])]),e("b-table-column",{attrs:{field:"last_name",label:"Apellido",sortable:"",searchable:""}},[e("span",{staticClass:"is-capitalized"},[t._v(t._s(a.row.last_name))])]),e("b-table-column",{attrs:{field:"created",label:"Creado",sortable:"",searchable:""}},[e("span",{staticClass:"tag has-text-weight-bold is-uppercase"},[t._v(t._s(t._f("adjustShortTZ")(a.row.created)))])]),e("b-table-column",{attrs:{field:"lastlogin",label:"Última actividad",sortable:"",searchable:""}},[e("span",{staticClass:"tag has-text-weight-bold is-uppercase"},[t._v(t._s(t._f("adjustShortTZ")(a.row.lastlogin)))])]),e("b-table-column",{staticClass:"is-actions-cell",attrs:{field:"enabled",label:"Habilitado",numeric:""}},[e("div",{staticClass:"buttons is-right"},[e("b-switch",{on:{input:function(e){return t.toggleShopStatus(a.row)}},model:{value:a.row.enabled,callback:function(e){t.$set(a.row,"enabled",e)},expression:"props.row.enabled"}})],1)]),e("b-table-column",{staticClass:"is-actions-cell",attrs:{field:"featured",label:"Comunidad",numeric:""}},[e("div",{staticClass:"buttons is-right"},[e("b-switch",{on:{input:function(e){return t.toggleShopFeatured(a.row)}},model:{value:a.row.featured,callback:function(e){t.$set(a.row,"featured",e)},expression:"props.row.featured"}})],1)])]}},{key:"detail",fn:function(a){return[e("table",{staticClass:"table is-details"},[e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Tienda")])]),e("td",[e("span",[t._v(t._s(a.row.shop))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Descripción")])]),e("td",[e("span",[t._v(t._s(a.row.text))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Tipo")])]),e("td",[e("span",{directives:[{name:"show",rawName:"v-show",value:"products"===a.row.type,expression:"props.row.type === 'products'"}]},[t._v("Productos")]),e("span",{directives:[{name:"show",rawName:"v-show",value:"services"===a.row.type,expression:"props.row.type === 'services'"}]},[t._v("Servicios")])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Propietario")])]),e("td",[e("span",[t._v(t._s(a.row.first_name)+" "+t._s(a.row.last_name))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Teléfono")])]),e("td",[e("span",[t._v(t._s(a.row.phone))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Email")])]),e("td",[e("span",[t._v(t._s(a.row.email))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Ubicación")])]),e("td",[e("span",[t._v(t._s(a.row.address)+" "+t._s(a.row.address_extra))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Asistente completado")])]),e("td",[e("span",[t._v(t._s(a.row.wizard_complete)+" "+t._s(a.row.wizard_complete_date))])])]),e("tr",[e("td",{attrs:{width:"1%"}},[e("span",[t._v("Email validado")])]),e("td",[e("span",[t._v(t._s(a.row.validated)+" "+t._s(a.row.validation_date))])])])]),e("div",{staticClass:"buttons is-flex-end"},[e("b-button",{attrs:{type:"is-danger"},on:{click:function(e){return e.preventDefault(),t.trashModal(a.row)}}},[t._v("Eliminar "+t._s(a.row.shop))])],1)]}}],null,!1,4005757089)})],1):e("notification",{staticClass:"is-info"},[e("p",[t._v("No se registran tiendas")])])],1)],1)},i=[],n=(e("a4d3"),e("4de4"),e("4160"),e("a15b"),e("e439"),e("dbb4"),e("b64b"),e("d3b7"),e("159b"),e("ade3")),o=e("2f62"),r=e("bc3a"),l=e.n(r),c=e("d000"),d=e("25f7"),u=e("6df7"),p=e("503b"),b=e("2b9d"),h=e("72d0");function f(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,s)}return e}function m(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?f(Object(e),!0).forEach((function(a){Object(n["a"])(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var v={name:"Sales",components:{ModalBox:h["a"],NavBar:c["a"],AsideMenu:d["a"],HeroBar:p["a"],CardComponent:u["a"],Notification:b["a"]},data:function(){return{isModalActive:!1,showDetailIcon:!1,defaultOpenedDetails:[],item:{},data:[]}},sockets:{sale:function(t){var a=this;this.isSaleBoxActive||this.isSaleDeliveryBoxActive?this.$buefy.toast.open({message:"Hay nuevas ventas"}):setTimeout((function(){a.getData()}),1e3)}},created:function(){this.getData()},computed:m({},Object(o["b"])(["basic"]),{trashObjectName:function(){return this.trashObject?this.trashObject.shop:null}}),methods:{toggleShopFeatured:function(t){var a=this,e={featured:t.featured};this.updateItem(t,e).then((function(s){a.setItem(t,e).then((function(t){a.$buefy.toast.open({message:"Estado de tienda actualizada"})}))}))},toggleShopStatus:function(t){var a=this,e={enabled:t.enabled};this.updateItem(t,e).then((function(s){a.setItem(t,e).then((function(t){a.$buefy.toast.open({message:"Estado de tienda actualizada"})}))}))},onRowClass:function(t,a){var e=[];return t.hidden&&e.push("is-hidden"),t.cancelled&&e.push("is-cancelled"),e.join(" ")},getData:function(){var t=this;this.$store.dispatch("loaded",!1),l.a.post("/shops/sort",{find:{},sort:{created:1}}).then((function(a){a.data.length&&(t.data=a.data),t.$store.dispatch("loaded",!0)}))},updateItem:function(t,a){return new Promise((function(e,s){l.a.post("/shops/".concat(t._id),a).then((function(a){e(t)}))}))},setItem:function(t,a){return new Promise((function(a,e){a(t)}))},trashModal:function(t){this.trashObject=t,this.isModalActive=!0},trashConfirm:function(){var t=this;this.isLoading=!0,this.isModalActive=!1,l.a.delete(["shops",this.trashObject._id].join("/")).then((function(a){l.a.delete(["stock","shop",t.trashObject._id].join("/")).then((function(a){t.data.filter((function(a){return a._id!==t.trashObject._id})),t.$buefy.toast.open({message:"Tienda eliminada"})}))}))},trashCancel:function(){this.isModalActive=!1}}},_=v,w=e("2877"),g=Object(w["a"])(_,s,i,!1,null,null,null);a["default"]=g.exports},"72d0":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b-modal",{attrs:{active:t.isModalActive,"has-modal-card":""},on:{"update:active":function(a){t.isModalActive=a}}},[e("div",{staticClass:"modal-card"},[e("header",{staticClass:"modal-card-head"},[e("p",{staticClass:"modal-card-title"},[t._v("Confirmar acción")])]),e("section",{staticClass:"modal-card-body"},[e("p",[t._v("Esta acción eliminará de forma permanente "),e("b",[t._v(t._s(t.trashObjectName))])])]),e("footer",{staticClass:"modal-card-foot"},[e("button",{staticClass:"button ",attrs:{type:"button"},on:{click:t.cancel}},[t._v("Cancelar")]),e("button",{staticClass:"button is-danger ",on:{click:t.confirm}},[t._v("Eliminar")])])])])},i=[],n={name:"ModalBox",props:{isActive:{type:Boolean,default:!1},trashObjectName:{type:String,default:null}},data:function(){return{isModalActive:!1}},methods:{cancel:function(){this.$emit("cancel")},confirm:function(){this.$emit("confirm")}},watch:{isActive:function(t){this.isModalActive=t},isModalActive:function(t){t||this.cancel()}}},o=n,r=e("2877"),l=Object(r["a"])(o,s,i,!1,null,null,null);a["a"]=l.exports}}]);
//# sourceMappingURL=chunk-85800598.ca1a034b.js.map